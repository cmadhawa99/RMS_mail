{% extends 'letters/admin/shared/admin_base.html' %}
{% block admin_content %}

<div class="row align-items-center mb-4">
    <div class="col-md-6">
        <h3 class="fw-bold text-secondary mb-0">Registered Officers</h3>
    </div>
    <div class="col-md-6">
        <div class="d-flex gap-2 justify-content-md-end">
            <form method="get" class="d-flex flex-grow-1" style="max-width: 300px;">
                <div class="input-group shadow-sm">
                    <span class="input-group-text bg-white border-end-0"><i class="fas fa-search text-muted"></i></span>
                    <input type="text" name="q" class="form-control border-start-0 ps-0" placeholder="Search officers..." value="{{ search_query }}">
                    <button type="submit" class="btn btn-outline-secondary">Go</button>
                </div>
            </form>

            <a href="{% url 'create_user' %}" class="btn btn-primary shadow-sm text-nowrap">
                <i class="fas fa-user-plus me-2"></i>Add Officer
            </a>
        </div>
    </div>
</div>

<div class="card shadow-sm">
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
                <thead class="bg-light text-secondary">
                    <tr>
                        <th class="ps-4 py-3">OFFICER NAME</th>
                        <th>ASSIGNED SECTOR</th>
                        <th>ACTIONS</th>
                    </tr>
                </thead>
                <tbody>
                    {% for u in users %}
                    <tr>
                        <td class="ps-4">
                            <div class="d-flex align-items-center">
                                <div class="bg-primary text-white rounded-circle d-flex justify-content-center align-items-center me-3" style="width: 40px; height: 40px; font-weight: bold;">
                                    {{ u.username|make_list|first|upper }}
                                </div>
                                <div>
                                    <a href="{% url 'admin_user_detail' u.id %}" class="text-decoration-none fw-bold text-dark stretched-link">
                                        {{ u.first_name }} {{ u.last_name }}
                                    </a>
                                    <div class="small text-muted">@{{ u.username }}</div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <span class="badge bg-light text-dark border px-3 py-2 rounded-pill">
                                {{ u.sectorprofile.sector }}
                            </span>
                        </td>
                        <td style="z-index: 2; position: relative;">
                            <a href="{% url 'admin_user_detail' u.id %}" class="btn btn-sm btn-outline-secondary">
                                View Profile
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="3" class="text-center py-5">
                            <div class="text-muted">
                                <i class="fas fa-search fa-2x mb-3 opacity-50"></i>
                                <p>No officers found matching your search.</p>
                                {% if search_query %}
                                <a href="{% url 'custom_admin_users' %}" class="btn btn-sm btn-link">Clear Search</a>
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}